#include <msp430.h> 

/**
 * main.c
 */

void main(void)
{
    WDTCTL = WDTPW | WDTHOLD;                    // Спри watchdog таймера
    PM5CTL0 &= ~0b00000001;                      // Изключи високоимпедансното състояние на GPIO                    

    // Тактов генератор DCO = 8MHz, MSP430FR6989 Userguide (стр. 104-107)
    CSCTL0_H = 0xA5;                             // Въвеждане на парола за отключване на CS регистрите
    CSCTL1 |= 0b01000000;                        // DCORSEL = 1
    CSCTL1 &= ~0b00001110;                       // Занули DCOFSEL битовете
    CSCTL1 |= 0b00000110;                        // Задай DCOFSEL битовете = 011b
    CSCTL2 = 0b00000000;                         // Занули всички битове от регистъра CSCTL2
    CSCTL2 |= 0b00100110011;                     // ACLK = VLOCLK; SMCLK = DCO; MCLK = DCO
    CSCTL3 = 0b00000000;                         // Занули всички битове от регистъра CSCTL3
    CSCTL3 |= 0b00000000000;                     // Всички делители на тактовите сигнали ÷ 1. Този ред е даден за пълнота
                                                 // Реално с предходния ред е извършена конфигурацията, тъй като трябва
                                                 // всички битове да са 0, за бъде коефициентът на делене 1 на делителите

    // Превключи мултиплексора на извод P2.6 към таймерния модул
    P2DIR |= 0b01000000;                         // P2.6 изход
    P2SEL0 |= 0b01000000;                        // P2.6 изход на
    P2SEL1 &= ~0b01000000;                       // таймерния модул TB0, capture/compare субмодул №5
    LCDCPCTL2 &= ~0b1000000000;                  // Изключи сигналът S41 на LCD модула

    //Превключи мултиплексора на извод P2.7 към таймерния модул
    P2DIR |= 0b10000000;                         // P2.7 изход
    P2SEL0 |= 0b10000000;                        // P2.7 изход на
    P2SEL1 &= ~0b10000000;                       // таймерния модул TB0, capture/compare субмодул №6
    LCDCPCTL2 &= ~0b1000000000;                  // Изключи сигналът S40 на LCD модула

    TB0CTL |= 0b1011010100;                      // SMCLK | SMCLK/8 | сумиращ брояч (up mode) | изчисти TBR

    TB0CCTL5 |= 0b11100000;                      // Включи логиката на изходния блок от субмодул №5 в режим Reset/set
    TB0CCTL6 |= 0b????????;                      // Включи логиката на изходния блок от субмодул №6 в противофаза
                                                 // на субмодул №5, MSP430FR6989 Userguide (стр. 684-685)

    TB0CCR0 = ????;                              // PWM период, MSP430FR6989 Userguide (стр. 686)
    TB0CCR5 = ???;                               // Време на импулса на извод P2.6 (PWM_TB0.5), MSP430FR6989 Userguide (стр. 686). Запишете в десетичен код
    TB0CCR6 = ???;                               // Време на импулса на извод P2.7 (PWM_TB0.6), MSP430FR6989 Userguide (стр. 686). Запишете в десетичен код

    while (1)
    {
        __bis_SR_register(CPUOFF | GIE);         // Изключи µPU за понижаване на консумацията
    }
}